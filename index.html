<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Home - Globeii</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  <!-- Main CSS -->
  <link rel="stylesheet" href="css/styles.css">

  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="supabase-config.js"></script>
</head>
<body>

  <!-- HEADER -->
  <div id="header-placeholder"></div>

  <!-- HERO (only for logged-out users) -->
  <div class="hero" id="heroSection">
    <div class="hero-content">
      <h1>Explore Your Next Adventure</h1>
      <p>Ready to start traveling? Enter your email to begin.</p>
      <div class="input-group" style="max-width: 400px;">
        <input type="email" class="form-control" id="heroEmail" placeholder="Your email" />
        <button class="btn btn-primary" id="getStartedBtn">Get Started →</button>
      </div>
    </div>
  </div>

  <!-- PRICING / PLANS SECTION (for logged-out users) -->
  <section class="pricing-section py-5 px-3" id="pricingSection" style="display:none;">
    <div class="text-center mb-5 px-3">
      <h1 class="mb-3">Choose Your Globeii Plan</h1>
      <p class="lead">Pick the plan that fits your travel style. Upgrade anytime to unlock more features!</p>
    </div>

    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4 justify-content-center">

      <!-- Free Plan -->
      <div class="col">
        <div class="card h-100 shadow-sm">
          <div class="card-header text-white bg-primary py-3 rounded-top">Free</div>
          <div class="card-body d-flex flex-column p-4">
            <div class="price mb-3 h2">$0</div>
            <ul class="list-unstyled flex-grow-1 text-start mb-4">
              <li><i class="fa-solid fa-check text-success me-2"></i>Create up to 3 itineraries</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Add up to 5 places per itinerary</li>
              <li><i class="fa-solid fa-xmark text-danger me-2"></i>Google Place API searches</li>
              <li><i class="fa-solid fa-xmark text-danger me-2"></i>Sharing itineraries</li>
              <li><i class="fa-solid fa-xmark text-danger me-2"></i>Export (PDF) itinerary details</li>
              <li><i class="fa-solid fa-xmark text-danger me-2"></i>Expense tracking with IRS-ready expense reports</li>
              <li><i class="fa-solid fa-xmark text-danger me-2"></i>Smart recommendations & tips</li>
              <li><i class="fa-solid fa-xmark text-danger me-2"></i>AI features</li>
              <li class="text-muted mt-2"><em>Try Globeii risk-free and get a taste of what’s possible.</em></li>
            </ul>
            <a href="signup.html" class="btn btn-outline-primary mt-auto py-2">Get Started</a>
          </div>
        </div>
      </div>

      <!-- Globeii -->
      <div class="col">
        <div class="card h-100 shadow-sm">
          <div class="card-header text-white bg-success py-3 rounded-top">Globeii</div>
          <div class="card-body d-flex flex-column p-4">
            <div class="price mb-3 h2">$5/mo</div>
            <ul class="list-unstyled flex-grow-1 text-start mb-4">
              <li><i class="fa-solid fa-check text-success me-2"></i>Create up to 10 itineraries</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Add up to 25 places per itinerary</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Limited Google Place API searches</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Share each itinerary with 1 user</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Export (PDF) itinerary details</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Smart recommendations & tips</li>
              <li><i class="fa-solid fa-xmark text-danger me-2"></i>Expense tracking with IRS-ready expense reports</li>
              <li><i class="fa-solid fa-xmark text-danger me-2"></i>AI features</li>
              <li class="text-muted mt-2"><em>Enjoy most features with reasonable limits — perfect for casual travelers.</em></li>
            </ul>
            <a href="upgrade.html" class="btn btn-success mt-auto py-2">Upgrade</a>
          </div>
        </div>
      </div>

      <!-- Globeii Pro -->
      <div class="col">
        <div class="card h-100 shadow-sm">
          <div class="card-header text-white bg-warning py-3 rounded-top">Globeii Pro</div>
          <div class="card-body d-flex flex-column p-4">
            <div class="price mb-3 h2">$15/mo</div>
            <ul class="list-unstyled flex-grow-1 text-start mb-4">
              <li><i class="fa-solid fa-check text-success me-2"></i>Create <strong class="text-warning">UNLIMITED*</strong> itineraries</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Add <strong class="text-warning">UNLIMITED*</strong> places per itinerary</li>
              <li><i class="fa-solid fa-check text-success me-2"></i><strong class="text-warning">UNLIMITED*</strong> Google Place API searches</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Share each itinerary with 5 users</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Export (PDF) itinerary details</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Expense tracking with IRS-ready expense reports</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Smart recommendations & tips</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>AI-assisted itinerary planning</li>
              <li class="text-muted mt-2"><em>Unlock nearly unlimited travel planning power, including AI-assisted itineraries.</em></li>
            </ul>
            <a href="upgrade.html" class="btn btn-warning mt-auto py-2">Upgrade</a>
          </div>
        </div>
      </div>

      <!-- Enterprise -->
      <div class="col">
        <div class="card h-100 shadow-sm">
          <div class="card-header text-white bg-dark py-3 rounded-top">Enterprise</div>
          <div class="card-body d-flex flex-column p-4">
            <div class="price mb-3 h2">Custom</div>
            <ul class="list-unstyled flex-grow-1 text-start mb-4">
              <li><i class="fa-solid fa-check text-success me-2"></i>Team & agency management</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Multi-user accounts & licenses</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Clone itineraries</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Priority support & analytics</li>
              <li><i class="fa-solid fa-check text-success me-2"></i>Full access to all features for all users</li>
              <li class="text-muted mt-2"><em>Designed for travel agencies and teams — full access, AI, multi-user accounts, and priority support for your entire organization.</em></li>
            </ul>
            <a href="contact.html" class="btn btn-dark mt-auto py-2">Contact Sales</a>
          </div>
        </div>
      </div>

    </div>

    <p class="text-muted small mt-3 text-center">*Unlimited features are subject to fair use.</p>
  </section>

  <!-- MAIN CONTENT -->
  <div class="container-center text-center">
    <h2 id="welcomeText"></h2>
    <div id="statusMessage" class="text-center text-success my-3"></div>
    <div id="actionButtons" class="d-flex flex-column gap-2"></div>
  </div>

  <!-- FOOTER -->
  <div id="footer-placeholder"></div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Load layout (header + footer + header.js) -->
  <script src="js/layout.js"></script>

  <!-- Home page logic (page-specific) -->
  <script>
    
    window.addEventListener('DOMContentLoaded', () => {
      const hash = window.location.hash.substring(1); // get everything after #
      const params = new URLSearchParams(hash);

      const message = params.get('message');
      const type = params.get('type'); // e.g., "signup", "recovery", "email_change"
      const sb = params.get('sb');

      // Show message if type=email_change
      if (type === 'email_change') {
        const statusEl = document.getElementById('statusMessage');
        statusEl.textContent = 'Email Change Successful!';
      }

      // Existing check for generic confirmation message
      if (message && message.includes('Confirmation link accepted')) {
        // Optional: redirect to your dedicated page
        window.location.href = '/email-confirmed/?message=' + encodeURIComponent(message);
      }
    });

    async function loadHomePage() {
      const { data: { user } } = await supabaseClient.auth.getUser();

      const hero = document.getElementById('heroSection');
      const welcomeText = document.getElementById('welcomeText');
      const actionButtons = document.getElementById('actionButtons');

      welcomeText.textContent = '';
      actionButtons.innerHTML = '';

      if (user) {
        // Logged in
        hero.style.display = 'none';

        document.getElementById('pricingSection').style.display = 'none';

        // Get user profile
        const { data: profile } = await supabaseClient
          .from('app_users')
          .select('first_name')
          .eq('id', user.id)
          .single();

        welcomeText.textContent = `Welcome back, ${profile?.first_name || user.email}`;

        actionButtons.innerHTML = `
          <a href="create-trip.html" class="btn btn-primary">Create Trip</a>
          <a href="itineraries.html" class="btn btn-secondary">View My Itineraries</a>
        `;
      } else {
        // Logged out
        hero.style.display = 'block';

        document.getElementById('pricingSection').style.display = 'block';

        document.getElementById('getStartedBtn').onclick = () => {
          const email = document.getElementById('heroEmail').value;
          if (!email) return alert('Please enter your email');
          window.location.href =
            `create-account.html?email=${encodeURIComponent(email)}`;
        };
      }
    }

    // Run page-specific logic after layout (header/footer) is fully loaded
    window.layoutReady.then(loadHomePage);
  </script>

</body>
</html>